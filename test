from docx import Document

print("Script started")

def extract_data_from_docx(docx_filename):
    # Open the Word document
    document = Document(docx_filename)

    # Iterate through each table in the document
    for table_index, table in enumerate(document.tables):

        print(f"Checking table {table_index+1}")

        # Iterate through each row in the table
        for row_index, row in enumerate(table.rows):

            print(f"Checking row {row_index+1}")

            # Iterate through each cell in the row
            for cell_index, cell in enumerate(row.cells):

                print(f"Checking cell {cell_index+1}: '{cell.text}'")

                # Check if the cell text is "Image Name : Version"
                if "Image Name : Version" in cell.text:

                    # If the cell contains the text, return the text from the next cell
                    if cell_index+1 < len(row.cells):
                        print("Found 'Image Name : Version', returning next cell")
                        return row.cells[cell_index+1].text
                    else:
                        print("Found 'Image Name : Version', but there's no next cell")
                        return "No content following 'Image Name : Version'"

    print("No cell found with 'Image Name : Version'")
    return "No cell found with 'Image Name : Version'"

# If Python script and Word document are in the same folder, you can just use the filename
docx_filename = 'your_file.docx'

content = extract_data_from_docx(docx_filename)
print(content)
