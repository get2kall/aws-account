import json

# Configurable fields
scan_tool = 'snyk'
registry = 'docker.io'
repository_name = 'testing'

# Input and output files
input_file = 'images.txt'
output_file = 'images.json'

# Read the data from the text file
with open(input_file, 'r') as f:
    lines = f.readlines()

# Process each line and add the additional fields
data = []
for line in lines:
    image, version = line.strip().split(':')
    image_data = {
        'registry': registry,
        'image': image,
        'version': version,
        'scanTool': scan_tool,
        'repositoryName': repository_name,
    }
    data.append(image_data)

# Write the data to the JSON file
with open(output_file, 'w') as f:
    json.dump(data, f, indent=4)
