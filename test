import csv
import mysql.connector

# Function to sanitize strings
def sanitize_string(str):
    return "".join([ch for ch in str if ch.isalnum() or ch in (' ', '-', '_')])

# Set up the database connection
conn = mysql.connector.connect(
    host="hostname",
    database="database_name",
    user="username",
    password="password",
)

# Create a new cursor
cur = conn.cursor()

# Create the new table
cur.execute("""
    CREATE TABLE IF NOT EXISTS image_data (
        image VARCHAR(255),
        status VARCHAR(255) NULL
    )
""")

# Open the CSV file
with open('output1.csv', 'r') as f:
    reader = csv.reader(f)
    next(reader)  # Skip the header row
    for row in reader:
        # Sanitize strings and replace empty strings with None
        sanitized_row = [sanitize_string(value) if value != "" else None for value in row]

        # Insert each row into the database
        cur.execute(
            "INSERT INTO image_data (image, status) VALUES (%s, %s)",
            sanitized_row
        )

# Commit the changes and close the connection
conn.commit()
cur.close()
conn.close()
